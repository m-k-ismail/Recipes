# Recipe Java Web Application

A standalone java application which allows users to manage their favourite recipes. It
allows adding, updating, removing and fetching recipes. Additionally, users can do
paginated filtering to find recipes based on one or more of the following criteria:

1. Whether or not the dish is vegetarian
2. The number of servings
3. Specific ingredients (either include or exclude)
4. Text search within the instructions.


## Tech Stack
Feature | Tech. Stack
------------ | -------------
BE | Java 11, Spring Boot
Web Server | Tomcat
APIs | RESTful APIs, [OpenAPI](https://spec.openapis.org/oas/latest.html)
API Authentication | [Spring Security](https://spring.io/projects/spring-security), JWT Token
DAO Layer  | [Spring Data JPA](https://spring.io/projects/spring-data-jpa)
Database | PostgreSQL
Exception Handling | Spring ExceptionHandler
Logging | Lombok Log4j2
Unit Tests | Junit 5, Mockito
Integration Tests | Karate
Cluster Manager | Docker

## Quick Start
This project supports using docker compose.
* Clone the repository
* Run Maven build command `mvn clean package`
* Run `docker-compose up`
* [Generate a JWT token through "authenicate" API](./README.md#authentication)  (The token will be valid for 24 hours)
* Update your API headers to use the newly generated token

You can find a full postman collection for all the APIs under `src/main/resources/postman/Recipe.postman_collection.json`

## Design

### APIs

All the APIs that were created in this project are RESTful APIs that are generated by using Openapi. You can access the
API documentation by running the application and then using this url http://localhost:8080/swagger-ui.html

The YAML files that the Openapi is using to generate the APIs interfaces can be found under `src/main/resources/api`

### Service Layer

This is the layer that connects the API controllers with the data access layer. It's mainly responsible for executing
the functional flows of the Recipe APIs and preparing the data for the data access layer.

### Data Access Layer

JPA was mainly used in this layer which contains the entities and recipe repository. JPA specification were used as well
since the users of the search API can enter different parameters and with JPA specification 
we can handle generating reusable queries for all the different needed cases.

### Database

PostgreSQL was used as the database for this project. The project leverages from the capabilities of full text search 
that comes with PostgreSQL by using text search vectors and text search query.

There's a script called init.sql can be found under `src/main/resources/sql` which contains the SQL 
queries that needs to be executed in order to set up the database tables. Two tables were used, recipe and ingredient.

The project also provides a docker-compose file that can create a PostgreSQL image, and it is using the same
SQL script to initialize the tables.

### Authentication

Spring Security and JWT were both used to handle the authentication of all Recipe APIs.

You can use http://localhost:8080/v1/authenticate to generate a web token and then update all of  
your API headers to use the newly generated token. Header formate is: "Bearer %generated token%"

username : abnamro
<br>
password: abnamro

### Integration Tests

Karate is being used for the integration tests in this project. The tests cover failure and success cases. Also, all
the cases that were mentioned in the assignments for filtering have integration tests.

All integration tests are included under `src/test/java/integrationtests` and the results can be found under
`target/karate-reports/karate-summary.html` after the tests are excuted.